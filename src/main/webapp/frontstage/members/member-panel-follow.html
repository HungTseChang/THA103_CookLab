<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="cooking recipe" />
    <meta name="keywords" content="cooking, recipe, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>廚藝實驗室</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet" />

    <!-- Css Styles -->
    <link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../ss/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="../css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="../css/jquery-ui.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/style.css" type="text/css" />
    <link rel="stylesheet" href="./css/ding.css" type="text/css" />
    <link rel="stylesheet" href="../bootstrap-icons-1.10.5/font/bootstrap-icons.css" />
    <style>
      .Tom {
          background-color: #f7e3d1; /* 深灰色背景颜色 */
      }
      .Tom_NCID {
        display: none;
      }
      .Tom_ReadStatus{
        display: none;
      }

  </style>
  </head>

  <body>
    <!-- Page Preloder -->
    <div id="preloder">
      <div class="loader"></div>
    </div>

    <!-- Humberger Begin -->
    <div class="humberger__menu__overlay"></div>
    <div class="humberger__menu__wrapper">
      <div class="humberger__menu__logo">
        <a href="#"><img src="../img/indexlogo.png" alt="" /></a>
      </div>
      <section class="container">
        <div class="humberger__menu__widget row d-flex justify-content-between align-items-center">
          <div class="">
            <a href="#">
              <i class="bi bi-cart3 fa-3x"></i>
            </a>
          </div>

          <div class="">
            <a href="#">
              <i class="fa fa-user fa-3x"></i>
            </a>
          </div>

          <div class="">
            <a href="#">
              <i class="bi bi-bell fa-3x"></i>
            </a>
          </div>
        </div>
      </section>
      <nav class="humberger__menu__nav mobile-menu">
        <ul>
          <li class="active"><a href="./index.html">首頁</a></li>
          <li><a href="./shop-grid.html">商城</a></li>
          <li><a href="./blog.html">食譜總覽</a></li>
          <li><a href="./contact.html">常見問題</a></li>
        </ul>
      </nav>
      <div id="mobile-menu-wrap"></div>
      <div class="header__top__right__social">
        <a href="#"><i class="fa fa-2x fa-facebook"></i></a>
        <a href="#"><i class="fa fa-2x fa-instagram"></i></a>
        <a href="#"><i class="fa fa-2x fa-twitter"></i></a>
      </div>
      <div class="humberger__menu__contact">
        <ul>
          <li>
            <i class="fa fa-envelope"></i>
            tomato@cooklab.com
          </li>
        </ul>
      </div>
    </div>
    <!-- Humberger End -->

    <!-- Header Section Begin -->
    <header class="header">
      <div class="header__top">
        <div class="container">
          <div class="row">
            <div class="col-lg-6"></div>
            <div class="col-lg-6">
              <div class="header__top__right">
                <div class="header__top__right__auth">
                  <a href="#">
                    <i class="bi bi-cart3 m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">購物車</span>
                  </a>
                </div>
                <div class="header__top__right__auth">
                  <a href="./member-panel.jsp">
                    <i class="fa fa-user m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">會員中心</span>
                  </a>
                </div>
                <div class="header__top__right__auth">
                  <a href="#" class="m-0 ml-2 ding-nav-text">登入/註冊</a>
                </div>
                <div class="header__top__right__auth">
                  <a href="#">
                    <i class="bi bi-bell m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">通知中心</span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-lg-3">
            <div class="header__logo">
              <a href="./index.html"><img style="height: 150px" src="../img/indexlogo.png" alt="" /></a>
            </div>
          </div>
          <div class="col-lg-9 d-flex align-items-center">
            <nav class="header__menu">
              <ul>
                <li class="active"><a href="./index.html">食譜總覽</a></li>
                <li><a href="#">新增食譜</a></li>
                <li><a href="#">關注食譜</a></li>
                <li><a href="./shop-grid.html">商城</a></li>
                <li><a href="#">討論區</a></li>
                <li><a href="#">客服中心</a></li>
                <li><a href="./contact.html">關於我們</a></li>
              </ul>
            </nav>
          </div>
        </div>
        <div class="humberger__open">
          <i class="fa fa-bars"></i>
        </div>
      </div>
    </header>
    <!-- Header Section End -->

    <!-- 會員中心區塊開始 -->
    <section>
      <div class="container">
        <div class="row ding-panel">
          <aside class="col-3">
            <div>
              <ul class="list-group text-center">
                <a href="./member-panel.jsp"><li class="list-group-item list-group-item-action">帳戶</li></a>
                <a href="./member-panel-order.html"><li class="list-group-item list-group-item-action">訂單</li></a>
                <a href="./member-panel-follow.html"><li class="list-group-item list-group-item-action active mem-panel-asidebar" aria-current="true">關注</li></a>
                <a href="./member-panel-recipe.html"><li class="list-group-item list-group-item-action">食譜</li></a>
                <a href="./member-panel-post.html"><li class="list-group-item list-group-item-action">討論區文章</li></a>
                <a href="./member-panel-news.html"><li class="list-group-item list-group-item-action">通知中心</li></a>
              </ul>
            </div>
          </aside>
          <div class="col-9 p-1 bg-light">
            <!-------------關注區塊開始----------->
            <ul class="nav nav-pills mt-3 ml-4" id="pills-tab" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active btn btn-lg ding-btn-outline-org ding-fol-border" id="pills-folrec-tab" data-toggle="pill" data-target="#pills-folrec" type="button" role="tab" aria-controls="pills-folrec" aria-selected="true">關注食譜</button>
              </li>
              <li class="nav-item ml-2" role="presentation">
                <button class="nav-link btn btn-lg ding-btn-outline-org ding-fol-border" id="pills-folmem-tab" data-toggle="pill" data-target="#pills-folmem" type="button" role="tab" aria-controls="pills-folmem" aria-selected="false">關注會員</button>
              </li>
              <li class="nav-item ml-2" role="presentation">
                <button class="nav-link btn btn-lg ding-btn-outline-org ding-fol-border" id="pills-folart-tab" data-toggle="pill" data-target="#pills-folart" type="button" role="tab" aria-controls="pills-folart" aria-selected="false">關注文章</button>
              </li>
            </ul>
            <div class="tab-content mt-3" id="pills-tabContent">
              <!-- 關注分頁-食譜開始 -->
              <div class="tab-pane fade show active" id="pills-folrec" role="tabpanel" aria-labelledby="pills-folrec-tab">
              </div>
              <!-- 關注分頁-食譜結束 -->
              <!-- 關注分頁-會員開始 -->
              <div class="tab-pane fade" id="pills-folmem" role="tabpanel" aria-labelledby="pills-folmem-tab">
                <!-- 關注會員模板開始 -->
                
              
              <!-- 關注分頁-會員結束 -->
              <!-- 關注分頁-文章開始 -->
              </div>
              <div class="tab-pane fade" id="pills-folart" role="tabpanel" aria-labelledby="pills-folart-tab">
                <!-- 範例列表開始 -->

                <!-- 範例列表結束 -->
              </div>
              <!-- 關注分頁-文章結束 -->
            </div>
            <!--------------關注區塊結束---------->
          </div>
        </div>
      </div>
    </section>
    <!-- 會員中心區塊結束 -->

    <!-- Footer Section Begin -->
    <footer class="footer spad">
      <div class="container">
        <div class="row">
          <div class="col-lg-4">
            <div class="footer__about">
              <ul>
                <li>公司地址：台北市中山區南京東路三段219號5樓</li>
                <li>電話：(02)27120589</li>
                <li>電子信箱：tomato@cooklab.com</li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="footer__widget">
              <ul>
                <li><a href="#">關於我們</a></li>
                <li><a href="#">關於商店</a></li>
                <li><a href="#">安心購物</a></li>
              </ul>
              <ul>
                <li><a href="#">運送資訊</a></li>
                <li><a href="#">隱私政策</a></li>
                <li><a href="#">常見問題</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4 col-md-12">
            <div class="footer__widget">
              <h6>立即訂閱電子報</h6>
              <p>隨時接收我們的最新消息以及優惠訊息</p>
              <form action="#">
                <input type="text" placeholder="輸入您的電子信箱" />
                <img src="${m.memberPicture}" />
                <button type="submit" class="btn ding-btn-org">訂閱</button>
              </form>
              <div class="footer__widget__social">
                <a href="#"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
            <div class="footer__copyright">
              <div class="footer__copyright__text">
                <p>
                  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                  Copyright &copy;
                  <script>
                    document.write(new Date().getFullYear());
                  </script>
                  All rights reserved | This template is made with
                  <i class="fa fa-heart" aria-hidden="true"></i>
                  by
                  <a href="https://colorlib.com" target="_blank">Colorlib</a>
                  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/jquery.nice-select.min.js"></script>
    <script src="../js/jquery-ui.min.js"></script>
    <script src="../js/jquery.slicknav.js"></script>
    <script src="../js/mixitup.min.js"></script>
    <script src="../js/owl.carousel.min.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/TomJS.js"></script>
    <script>
            /*============================================================ 變數 ============================================================*/
var queryString = window.location.search;
var params = new URLSearchParams(queryString);

var recipeBrowse = "/recipe/recipe_browse.jsp";
// var coverImage = "/RecipeServletImg";
var recipeServlet = "/";
var host = window.location.host;
var path = window.location.pathname;
var webCtx = path.substring(0, path.indexOf('/', 1));
var endPointURL = "http://" + host + webCtx;
console.log(endPointURL);
/*============================================================ ajax ============================================================*/
function articleAppend(a){
  let stringAppend=`
            <div class="row m-0 ml-2 my-3 ding-folrec-border ArticleName${a.articleCollectionNo}">
                  <div class="col-7 d-flex align-items-center">
                    <a href="#" class="text-dark ding-post-title">
                      [
                      <span>${a.articleCategory}</span>
                      ]
                      <span>${a.articleTitle}</span>
                    </a>
                  </div>
                  <div class="col-3 d-flex align-items-center">
                    <a href="#" class="text-dark ding-post-title">${a.memberNickname}</a>
                  </div>
                  <div class="col-2 mb-2">
                    <div>
                      <button type="button" class="btn ding-btn-outline-org Article-cancelBtn" onclick="articleUnFollow(${a.articleCollectionNo})">取消關注</button>
                    </div>
                  </div>
                </div>`;
            $("#pills-folart").append(stringAppend);
}

function MemberAppend(m){
  let stringAppend = `
              
                <div class="row m-0 ml-2 ding-folrec-border MemberName${m.memberId}">
                  <div class="col-3 align-self-center text-center p-0 py-2">
                    <img src="data:image/png;base64,${m.memberPicture}" alt="關注會員頭像" class="img-thumbnail ding-folmem-preview" />
                  </div>
                  <div class="col-7">
                    <div class="row h-100">
                      <div class="col-12"><a href="#" class="text-dark ding-fol-title">${m.memberNickName}</a></div>
                      <div class="col-12 text-muted my-1">${m.memberIntorduce}</div>
                      <div class="col-12 text-muted my-1">
                        <span>近期食譜：</span>

                      </div>
                    </div>
                  </div>
                  <div class="col-2 align-self-center">
                    <div>
                      <button type="button" class="btn ding-btn-outline-org Member-cancelBtn" onclick="memberUnFollow(${m.memberId})">取消關注</button>
                    </div>
                  </div>
                </div>`;
            $("#pills-folmem").append(stringAppend);
}

function RecipeAppend(r){
  let stringAppend = `              
                <div class="row m-0 ml-2 ding-folrec-border RecipeName${r.recipeCollectionNo}">
                  <div class="col-3 align-self-center p-0 pb-2">
                    <img src="data:image/png;base64,${r.coverImage}" alt="食譜封面圖" class="folrec-img-preview" />
                  </div>
                  <div class="col-7">
                    <div class="row h-100">
                      <div class="col-12"><a href="#" class="text-dark ding-fol-title">${r.recipeName}</a></div>
                      <p class="col-12 text-muted my-1">${r.introduction}</p>
                    </div>
                  </div>
                  <div class="col-2">
                    <div class="row h-100">
                      <div class="col-12 mb-2 align-self-end">
                        <div>
                          <button type="button" class="btn ding-btn-outline-org Recipe-cancelBtn" onclick="recipeUnFollow(${r.recipeCollectionNo})">取消關注</button>
                        </div>
                      </div>
                      <div class="col align-self-end pb-2">
                        <i class="bi bi-clock mr-1"></i>
                        <span>${r.toatalStepTime}</span>
                        分鐘
                      </div>
                    </div>
                  </div>
                `;
            $("#pills-folrec").append(stringAppend);
}
var recipeCollectionNo;//食譜收藏編號

// function reipceLoad(page) {
	$.ajax({
		url: endPointURL + "/FollowServlet", // 資料請求的網址
		type: "POST", // GET | POST | PUT | DELETE | PATCH
		data: { action: "overview" }, // 將物件資料(不用雙引號) 傳送到指定的 url
		dataType: "json", // 預期會接收到回傳資料的格式： json | xml | html
		success: function(data) {
			$(data).each(function(index, element) {
        console.log(element);
        $(element.ArticleList).each(function(index, power) {
          if(power.articleStatus == 0)
           articleAppend(power);
        })
        $(element.MemberList).each(function(index, power) {
          if(power.memberStatus != 2)
           MemberAppend(power);
        })
        $(element.RecipeList).each(function(index, power) {
          if(power.recipeStatus == 1)
            RecipeAppend(power);
        })
			});
      // var MN = MemberName;
		},
		error: function(xhr) {
		},
	});
  //取消關注會員AJAX
  function memberUnFollow(e){
    var result = confirm("確定取消關注?");
    //使用者按下確認後
    if (result) {
      $.ajax({
        url: endPointURL + "/FollowServlet", // 資料請求的網址
        type: "POST", // GET | POST | PUT | DELETE | PATCH
        data: { action: "delMemberCO",CollectionID:e }, // 將物件資料(不用雙引號) 傳送到指定的 url
        dataType: "json", // 預期會接收到回傳資料的格式： json | xml | html
        success: function(data) {
          
          $(`.MemberName${e}`).remove();
          console.log("網頁重新整理");
          // window.location.reload();
        },
        error: function(xhr) {
        },
      });
    } 
  }
  //食譜
  function recipeUnFollow(e){
    var result = confirm("確定取消關注?");
    //使用者按下確認後
    if (result) {
      $.ajax({
        url: endPointURL + "/RecipeCollectionServlet", // 資料請求的網址
        type: "POST", // GET | POST | PUT | DELETE | PATCH
        data: { action: "delete",recipeCollectionNo:e }, // 將物件資料(不用雙引號) 傳送到指定的 url
        dataType: "json", // 預期會接收到回傳資料的格式： json | xml | html
        success: function(data) {
          
          $(`.RecipeName${e}`).remove();
          console.log("網頁重新整理");
          // window.location.reload();
        },
        error: function(xhr) {
        },
      });
    } 
  }
  //文章
  function articleUnFollow(e){
    var result = confirm("確定取消關注?");
    //使用者按下確認後
    if (result) {
      $.ajax({
        url: endPointURL + "/FollowServlet", // 資料請求的網址
        type: "POST", // GET | POST | PUT | DELETE | PATCH
        data: { action: "delArticleCO",CollectionID:e }, // 將物件資料(不用雙引號) 傳送到指定的 url
        dataType: "json", // 預期會接收到回傳資料的格式： json | xml | html
        success: function(data) {
          
          $(`.ArticleName${e}`).remove();
          console.log("網頁重新整理");
          // window.location.reload();
        },
        error: function(xhr) {
        },
      });
    } 
  }
  // $(".Recipe-cancelBtn").on("click",function(e){

  // });
  
        // // 获取所有具有 class="Tom" 的链接
        // const tomLinks = document.querySelectorAll(".Tom");

        // // 找每個連結並裝置監聽
        // tomLinks.forEach(link => {
        //   link.addEventListener("mouseenter", () => {
        //     // 當滑鼠滑過時 .Tom_NCID 的值
        //     const spanValue = link.querySelector(".Tom_NCID").textContent;
        //     const ReadStatus = link.querySelector(".Tom_ReadStatus").textContent;
        //     link.classList.remove("Tom");
        //     //如果是未讀取就觸發GET方法送請求去資料庫
        //     console.log("Tom_NCID 值: " + ReadStatus);
        //     if(ReadStatus == 0)
        //       UnReadToRead(spanValue);
        //     console.log("Tom_NCID 值: " + spanValue);
        //   });
        // });
    </script>
  </body>
</html>
