<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="cooking recipe" />
    <meta name="keywords" content="cooking, recipe, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>廚藝實驗室</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet" />

    <!-- Css Styles -->
    <link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="../css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="../css/jquery-ui.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/style.css" type="text/css" />
    <link rel="stylesheet" href="../bootstrap-icons-1.10.5/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="./css/ding.css" type="text/css" />
  </head>

  <body>
    <!-- Page Preloder -->
    <div id="preloder">
      <div class="loader"></div>
    </div>

    <!-- Humberger Begin -->
    <div class="humberger__menu__overlay"></div>
    <div class="humberger__menu__wrapper">
        <div class="humberger__menu__logo">
            <a href="#"><img src="img/indexlogo.png" alt="" /></a>
        </div>
        <section class="container">
            <div
                class="humberger__menu__widget row d-flex justify-content-between align-items-center">
                <div class="">
                    <a href="#"> <i class="bi bi-cart3 fa-3x"></i>
                    </a>
                </div>

                <div class="">
                    <a href="#"> <i class="fa fa-user fa-3x"></i> 
                    </a>
                </div>

                <div class="">
                    <a href="#"> <i class="bi bi-bell fa-3x"></i>
                    </a>
                </div>
            </div>
        </section>
        <nav class="humberger__menu__nav mobile-menu">
            <ul>
                <li class=""><a href="../recipe/recipe_overview.jsp">首頁</a></li>
                <li><a href="../shopstage/shop.html">商城</a></li>
                <li><a href="../recipe/recipe_overview.jsp">食譜總覽</a></li>
                <li><a href="../supportform/faq.html">常見問題</a></li>
                <li><a href="../article/article_main.jsp">討論區</a></li> 
                <li><a href="../news/news.html">最新消息</a></li>
            </ul>
        </nav>
        <div id="mobile-menu-wrap"></div>
        <div class="header__top__right__social">
            <a href="#"><i class="fa fa-2x fa-facebook"></i></a> <a href="#"><i
                class="fa fa-2x fa-instagram"></i></a> <a href="#"><i
                class="fa fa-2x fa-twitter"></i></a>
        </div>
        <div class="humberger__menu__contact">
            <ul>
                <li><i class="fa fa-envelope"></i> tomato@cooklab.com</li>
            </ul>
        </div>
    </div>
    <!-- Humberger End -->

    <!-- Header Section Begin -->
    <header class="header">
      <div class="header__top">
        <div class="container">
          <div class="row">
            <div class="col-lg-6"></div>
            <div class="col-lg-6">
              <div class="header__top__right">
                <div class="header__top__right__auth">
                  <a href="../shopstage/shoping-cart.html">
                    <i class="bi bi-cart3 m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">購物車</span>
                  </a>
                </div>
                <div class="header__top__right__auth">
                  <a href="./member-panel.jsp">
                    <i class="fa fa-user m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">會員中心</span>
                  </a>
                </div>
                <div class="header__top__right__auth">
                  <a href="#" class="m-0 ml-2 ding-nav-text">登入/註冊</a>
                </div>
                <div class="header__top__right__auth">
                  <a href="./member-panel-news.html">
                    <i class="bi bi-bell m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">通知中心</span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-lg-3">
            <div class="header__logo">
              <a href="../recipe/recipe_overview.jsp"><img style="height: 150px" src="../img/indexlogo.png" alt="" /></a>
            </div>
          </div>
          <div class="col-lg-9 d-flex align-items-center">
            <nav class="header__menu">
              <ul>
                <li class=""><a href="../recipe/recipe_overview.jsp">食譜總覽</a></li>
                <li><a href="../recipe/recipe_create.jsp">新增食譜</a></li>
                <li><a href="../members/member-panel-follow.html">關注食譜</a></li>
                <li><a href="../shopstage/shop.html">商城</a></li>
                <li><a href="../article/article_main.jsp">討論區</a></li>
                <li><a href="../news/news.html ">最新消息</a></li>
                <li><a href="./contact.html">關於我們</a></li>
              </ul>
            </nav>
          </div>
        </div>
        <div class="humberger__open">
          <i class="fa fa-bars"></i>
        </div>
      </div>
    </header>
    <!-- Header Section End -->

    <!-- 會員中心區塊開始 -->
    <section>
      <div class="container">
        <div class="row ding-panel">
          <aside class="col-3">
            <div>
              <ul class="list-group text-center">
                <a href="./member-panel.jsp"><li class="list-group-item list-group-item-action">帳戶</li></a>
                <a href="./member-panel-order.html"><li class="list-group-item list-group-item-action">訂單</li></a>
                <a href="./member-panel-follow.html"><li class="list-group-item list-group-item-action ">關注</li></a>
                <a href="./member-panel-recipe.html"><li class="list-group-item list-group-item-action active mem-panel-asidebar" aria-current="true">食譜</li></a>
                <a href="./member-panel-post.html"><li class="list-group-item list-group-item-action">討論區文章</li></a>
                <a href="./member-panel-news.html"><li class="list-group-item list-group-item-action">通知中心</li></a>
              </ul>
            </div>
          </aside>
          <div class="col-9 p-1 bg-light">
            <div class="row w-100">
              <div class="h2 mx-auto mt-2">食譜清單</div>
              <div class="mt-2">
                <a href="../recipe/recipe_create.jsp"><button type="button" class="btn btn-lg ding-btn-org">
                  寫食譜
                  <i class="bi bi-plus-square ml-1"></i>
                </button></a>
              </div>
            </div>
            <!-------------食譜管理區塊開始----------->
            <!-- 食譜模板開始 -->
            <div id="recipeList">
     
            </div>
      
            <!--------------食譜管理區塊結束---------->
          </div>
        </div>
      </div>
    </section>
    <!-- 會員中心區塊結束 -->

    <!-- Footer Section Begin -->
    <footer class="footer spad">
      <div class="container">
        <div class="row">
          <div class="col-lg-4">
            <div class="footer__about">
              <ul>
                <li>公司地址：台北市中山區南京東路三段219號5樓</li>
                <li>電話：(02)27120589</li>
                <li>電子信箱：tomato@cooklab.com</li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="footer__widget">
              <ul>
                <li><a href="#">關於我們</a></li>
                <li><a href="#">關於商店</a></li>
                <li><a href="#">安心購物</a></li>
              </ul>
              <ul>
                <li><a href="#">運送資訊</a></li>
                <li><a href="#">隱私政策</a></li>
                <li><a href="#">常見問題</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4 col-md-12">
            <div class="footer__widget">
              <h6>立即訂閱電子報</h6>
              <p>隨時接收我們的最新消息以及優惠訊息</p>
              <form action="#">
                <input type="text" placeholder="輸入您的電子信箱" />
                <button type="submit" class="btn ding-btn-org">訂閱</button>
              </form>
              <div class="footer__widget__social">
                <a href="#"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
            <div class="footer__copyright">
              <div class="footer__copyright__text">
                <p>
                  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                  Copyright &copy;
                  <script>
                    document.write(new Date().getFullYear());
                  </script>
                  All rights reserved | This template is made with
                  <i class="fa fa-heart" aria-hidden="true"></i>
                  by
                  <a href="https://colorlib.com" target="_blank">Colorlib</a>
                  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="../js/popper.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/jquery.nice-select.min.js"></script>
    <script src="../js/jquery-ui.min.js"></script>
    <script src="../js/jquery.slicknav.js"></script>
    <script src="../js/mixitup.min.js"></script>
    <script src="../js/owl.carousel.min.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/TomJS.js"></script>
    <script>
      var queryString = window.location.search;
      var params = new URLSearchParams(queryString);

      var recipeBrowse = "/frontstage/recipe/recipe_browse.jsp";
      var coverImage = "/RecipeOverviewImgServlet";
      var host = window.location.host;
      var path = window.location.pathname;
      var webCtx = path.substring(0, path.indexOf('/', 1));
      var endPointURL = "http://" + host + webCtx;
      console.log(endPointURL);
      /*============================================================ function ============================================================*/
      // $(function() {
      //   reipceLoad(0);
      // })
        
      // <img src="${endPointURL + coverImage + "?recipeNo=" + recipe.recipeNo}" alt="食譜封面圖" class="rec-img-preview" />
      function addListRecipe(recipe) {
        var recipeStatusString ="";

        if(recipe.recipeStatus == 0)
          recipeStatusString ="公開"
        else if(recipe.recipeStatus == 1)
          recipeStatusString ="未公開"
        else if(recipe.recipeStatus == 2)
          recipeStatusString ="草稿"

        if(recipe.recipeStatus != 3)
        {
        let addrecipe = `<div id="recipeList">
              <div class="row m-0 ml-2 my-3 ding-folrec-border">
                <div class="col-3 align-self-center p-0 pb-2">
                  <img src="${endPointURL + coverImage + "?recipeNo=" + recipe.recipeNo}" alt="食譜封面圖" class="rec-img-preview" />
                </div>
                <div class="col-6">
                  <div class="row h-100">
                    <div class="col-12"><a href="${endPointURL + recipeBrowse + "?recipeNo=" + recipe.recipeNo}" class="text-dark ding-fol-title">${recipe.recipeName}</a></div>
                    <div class="col-12 text-muted my-1">${recipe.introduction}</div>
                    <div class="col-12 text-muted my-1">${recipe.recipeHashtag}</div>
                  </div>
                </div>
                <div class="col-3">
                  <div class="row text-right">
                    <div class="col-12 mb-2">
                      <a href="${endPointURL}/frontstage/recipe/recipe_update.jsp?recipeNo=${recipe.recipeNo}"><button type="button" class="btn ding-btn-org w-50">修改</button></a>
                    </div>
                    <div class="col-12 mb-2">
                      <a href="${endPointURL}/MemberRecipeServlet?recipeNo=${recipe.recipeNo}&recipeStatus=3"onclick="return confirm('確定刪除?')"><button type="button" class="btn ding-btn-org w-50">刪除</button></a>
                    </div>
                    <div class="dropdown col-12 mb-2">
                      <button class="btn ding-btn-org dropdown-toggle w-50" type="button" data-toggle="dropdown" aria-expanded="false" data-boundary="viewport">${recipeStatusString}</button>
                      <div class="dropdown-menu">
                        <a class="dropdown-item ding-dropdown-item" href="${endPointURL}/MemberRecipeServlet?recipeNo=${recipe.recipeNo}&recipeStatus=1" >公開</a>
                        <a class="dropdown-item ding-dropdown-item" href="${endPointURL}/MemberRecipeServlet?recipeNo=${recipe.recipeNo}&recipeStatus=2">未公開</a>
                      </div>
                    </div>
                    <div class="col-12 align-self-end text-right pb-2">
                      <i class="bi bi-clock mr-1"></i>
                      <span>${recipe.toatalStepTime}</span>
                      分鐘
                    </div>
                  </div>
                </div>
              </div>
            </div>`
        $("#recipeList").append(addrecipe);
      }
    }
      /*============================================================ event ============================================================*/
      $("#page").on("click", ".page", function() {
        $(".page").removeClass("disabled")
        $(this).addClass("disabled");
        $("html, body").animate({ scrollTop: 450 }, "slow");
      });


      /*============================================================ ajax ============================================================*/

      // function reipceLoad(page) {
        $.ajax({
          url: endPointURL + "/MemberRecipeServlet", // 資料請求的網址
          type: "POST", // GET | POST | PUT | DELETE | PATCH
          data:{action: "overview" }, // 將物件資料(不用雙引號) 傳送到指定的 url
          dataType: "json", // 預期會接收到回傳資料的格式： json | xml | html
          success: function(data) {
            
            console.log("ajax請求成功");
            console.log(data);
            $("#recipeList").html("");
            $(data).each(function(index, element) {
              addListRecipe(element);
            });
          },
          error: function(xhr) {
            console.log("ajax失敗2");
            console.log(xhr);
          },
        });
      // }
      // $.ajax({
      //   url: endPointURL + "/RecipeServlet", // 資料請求的網址
      //   type: "POST", // GET | POST | PUT | DELETE | PATCH
      //   data: { action: "getPage" }, // 將物件資料(不用雙引號) 傳送到指定的 url
      //   dataType: "json", // 預期會接收到回傳資料的格式： json | xml | html
      //   success: function(data) {
      //     for (let i = 0; i < data; i++)
      //       $("#page").append(`<a class="page" href="javascript:void(0);" onclick="reipceLoad(${i})">&nbsp;${i + 1}&nbsp;</a>`);
      //     $(".page").eq(0).addClass("disabled");
      //   },
      //   error: function(xhr) {
      //     console.log("ajax失敗");
      //     console.log(xhr);
      //   },
      // });

    </script>
  </body>
</html>
