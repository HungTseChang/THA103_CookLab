<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="CookLab Register" />
    <meta name="keywords" content="Recipe" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>會員註冊</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet" />

    <!-- Css Styles -->
    <link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="../css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="../css/jquery-ui.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/style.css" type="text/css" />
    <!-- bootstrap icon -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="./css/ding.css" type="text/css" />
  </head>

  <body>
    <!-- Page Preloder -->
    <div id="preloder">
      <div class="loader"></div>
    </div>

    <!-- Humberger Begin -->
    <div class="humberger__menu__overlay"></div>
    <div class="humberger__menu__wrapper">
      <div class="humberger__menu__logo">
        <a href="#"><img src="../img/indexlogo.png" alt="" /></a>
      </div>
      <section class="container">
        <div class="humberger__menu__widget row d-flex justify-content-between align-items-center">
          <div class="">
            <a href="#">
              <i class="bi bi-cart3 fa-3x"></i>
            </a>
          </div>

          <div class="">
            <a href="#">
              <i class="fa fa-user fa-3x"></i>
            </a>
          </div>

          <div class="">
            <a href="#">
              <i class="bi bi-bell fa-3x"></i>
            </a>
          </div>
        </div>
      </section>
      <nav class="humberger__menu__nav mobile-menu">
        <ul>
          <li class="active"><a href="./index.html">首頁</a></li>
          <li><a href="./shop-grid.html">商城</a></li>
          <li><a href="./blog.html">食譜總覽</a></li>
          <li><a href="./contact.html">常見問題</a></li>
        </ul>
      </nav>
      <div id="mobile-menu-wrap"></div>
      <div class="header__top__right__social">
        <a href="#"><i class="fa fa-2x fa-facebook"></i></a>
        <a href="#"><i class="fa fa-2x fa-instagram"></i></a>
        <a href="#"><i class="fa fa-2x fa-twitter"></i></a>
      </div>
      <div class="humberger__menu__contact">
        <ul>
          <li>
            <i class="fa fa-envelope"></i>
            tomato@cooklab.com
          </li>
        </ul>
      </div>
    </div>
    <!-- Humberger End -->

    <!-- Header Section Begin -->
    <header class="header">
      <div class="header__top">
        <div class="container">
          <div class="row">
            <div class="col-lg-6"></div>
            <div class="col-lg-6">
              <div class="header__top__right">
                <div class="header__top__right__auth">
                  <a href="#">
                    <i class="bi bi-cart3 m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">購物車</span>
                  </a>
                </div>
                <div class="header__top__right__auth">
                  <a href="./member-panel.jsp">
                    <i class="fa fa-user m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">會員中心</span>
                  </a>
                </div>
                <div class="header__top__right__auth">
                  <a href="#" class="m-0 ml-2 ding-nav-text">登入/註冊</a>
                </div>
                <div class="header__top__right__auth">
                  <a href="#">
                    <i class="bi bi-bell m-0 ml-2 fa-lg"></i>
                    <span class="ding-nav-text">通知中心</span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-lg-3">
            <div class="header__logo">
              <a href="./index.html"><img style="height: 150px" src="../img/indexlogo.png" alt="" /></a>
            </div>
          </div>
          <div class="col-lg-9 d-flex align-items-center">
            <nav class="header__menu">
              <ul>
                <li class="active"><a href="./index.html">食譜總覽</a></li>
                <li><a href="#">新增食譜</a></li>
                <li><a href="#">關注食譜</a></li>
                <li><a href="./shop-grid.html">商城</a></li>
                <li><a href="#">討論區</a></li>
                <li><a href="#">客服中心</a></li>
                <li><a href="./contact.html">關於我們</a></li>
              </ul>
            </nav>
          </div>
        </div>
        <div class="humberger__open">
          <i class="fa fa-bars"></i>
        </div>
      </div>
    </header>
    <!-- Header Section End -->

    <!-- 註冊區塊開始 -->
    <section>
      <div class="container">
        <div class="row ding-panel">
          <div class="col-12 p-2 bg-light border">
            <div class="row mb-2">
              <div class="h2 mx-auto ding-panel-title">註冊會員</div>
            </div>
            <div class="row">
              <div class="col-12 d-flex justify-content-center">
                <!-- -----------註冊表單開始----------->
                <form id="register_form">
                  <div class="form-group form-row">
                    <label for="account" class="col-form-label">帳號：</label>
                    <div>
                      <input type="text" class="form-control" id="account" placeholder="請輸入帳號" />
                    </div>
                  </div>
                  <div class="form-group form-row">
                    <label for="account" class="col-form-label">密碼：</label>
                    <div>
                      <input type="password" class="form-control" id="password" placeholder="請輸入密碼" />
                    </div>
                  </div>
                   <div class="form-group form-row">
                   <label for="account" class="col-form-label">再次輸入密碼：</label>
                   <div>
                     <input type="password" class="form-control" id="rePassword" placeholder="請輸入密碼" />
                   </div>
                  </div>
                  <div class="form-group form-row">
                    <label for="gender" class="col-sm-3 col-form-label ding-data-short">性別：</label>
                    <div class="col-sm-9">
                      <div class="custom-control custom-radio custom-control-inline mt-2">
                        <input type="radio" id="male" name="gender" class="custom-control-input" />
                        <label class="custom-control-label" for="male" value="0">男</label>
                      </div>
                      <div class="custom-control custom-radio custom-control-inline mt-2">
                        <input type="radio" id="female" name="gender" class="custom-control-input" />
                        <label class="custom-control-label" for="female" value="1">女</label>
                      </div>
                    </div>
                  </div>
                  <div class="form-group form-row">
                    <label for="nickname" class="col-form-label">暱稱：</label>
                    <div>
                      <input type="text" class="form-control" id="nickname" placeholder="請輸入暱稱" />
                    </div>
                  </div>
                  <div class="form-group form-row">
                    <label for="birthdate" class="col-form-label">生日：</label>
                    <div>
                      <input type="date" class="border" id="birthdate" name="birthdate" />
                    </div>
                  </div>
                  <div class="form-group form-row">
                    <label for="realname" class="col-form-label">地址：</label>
                    <div>
                      <input type="text" class="form-control" id="address" placeholder="請輸入地址" />
                    </div>
                  </div>
                  <div class="form-group form-row">
                    <label for="location" class="col-form-label">國別：</label>
                    <div>
                      <select id="locationC">
                        <option value="0">請選擇國別</option>
                    </select>
                    </div>
                  </div>
                  <div class="form-group form-row">
                    <label for="phonenumber" class="col-form-label">聯絡電話：</label>
                    <div>
                      <input type="text" class="form-control" id="phonenumber" placeholder="請輸入聯絡電話" />
                    </div>
                  </div>
                  <div class="form-group form-row">
                    <label for="email" class="col-form-label">電子信箱：</label>
                    <div>
                      <input type="text" class="form-control" id="email" placeholder="請輸入Email" />
                    </div>
                    
                    <!-- <div>
                      <button type="button" class="btn ding-btn-org ml-2">發送驗證信</button>
                    </div>-->
                  </div>
                  
                  <div class="form-group form-row">
					  <label for="introduction" class="col-sm-3 col-form-label ding-data-long">簡介：</label>
					  <div class="col-sm-9">
					    <textarea class="form-control" name="member_introduce" id="introduction" rows="5"></textarea>
					  </div>
				  </div>
                  <!-- <div class="form-group form-row">
                    <label for="VerificationCode" class="col-form-label">驗證碼：</label>
                    <div>
                      <input type="text" class="form-control" id="phonenumber" placeholder="請輸入驗證碼" />
                    </div>
                  </div>-->
                  <div class="text-center">
                    <button type="submit" class="btn ding-btn-org w-100">註冊</button>
                  </div>
                </form>
                <!-- -----------註冊表單結束--------- -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- 註冊區塊結束 -->

    <!-- Footer Section Begin -->
    <footer class="footer spad">
      <div class="container">
        <div class="row">
          <div class="col-lg-4">
            <div class="footer__about">
              <ul>
                <li>公司地址：台北市中山區南京東路三段219號5樓</li>
                <li>電話：(02)27120589</li>
                <li>電子信箱：tomato@cooklab.com</li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="footer__widget">
              <ul>
                <li><a href="#">關於我們</a></li>
                <li><a href="#">關於商店</a></li>
                <li><a href="#">安心購物</a></li>
              </ul>
              <ul>
                <li><a href="#">運送資訊</a></li>
                <li><a href="#">隱私政策</a></li>
                <li><a href="#">常見問題</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4 col-md-12">
            <div class="footer__widget">
              <h6>立即訂閱電子報</h6>
              <p>隨時接收我們的最新消息以及優惠訊息</p>
              <form action="#">
                <input type="text" placeholder="輸入您的電子信箱" />
                <button type="submit" class="btn ding-btn-org">訂閱</button>
              </form>
              <div class="footer__widget__social">
                <a href="#"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
            <div class="footer__copyright">
              <div class="footer__copyright__text">
                <p>
                  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                  Copyright &copy;
                  <script>
                    document.write(new Date().getFullYear());
                  </script>
                  All rights reserved | This template is made with
                  <i class="fa fa-heart" aria-hidden="true"></i>
                  by
                  <a href="https://colorlib.com" target="_blank">Colorlib</a>
                  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <!-- <script src="js/jquery.nice-select.min.js"></script> -->
    <script src="../js/jquery-ui.min.js"></script>
    <script src="../js/jquery.slicknav.js"></script>
    <script src="../js/mixitup.min.js"></script>
    <script src="../js/owl.carousel.min.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/TomJS.js"></script>
    <script>

    //___________________________________
    //性別按鈕
    var maleRadioButton = document.getElementById("male");
    var femaleRadioButton = document.getElementById("female");
    var gender = null;
    // 监听男性单选按钮的点击事件
    maleRadioButton.addEventListener("click", function() {
      // 当男性单选按钮被选中时，获取值 0
      if (maleRadioButton.checked) {
        gender = 0;
      }
    });

    // 监听女性单选按钮的点击事件
    femaleRadioButton.addEventListener("click", function() {
      // 当女性单选按钮被选中时，获取值 1
      if (femaleRadioButton.checked) {
        gender = 1;
      }
    });      
    var host = window.location.host;
      var path = window.location.pathname;
      var webCtx = path.substring(0, path.indexOf('/', 1));
      var endPointURL = "http://" + host + webCtx;
    //========================= 用 AJAX 傳送欄位驗證  ================================
        // 为表单提交按钮添加点击事件处理程序
    $("#register_form").submit(function (event) {
	      // console.log("eee");
	    // // 阻止表单默认提交行为
	    event.preventDefault();
	    // // 获取输入的用户名和密码
	    var account = $("#account").val();
	    var password = $("#password").val();
	    var rePassword = $("#rePassword").val();
	    var nickname = $("#nickname").val();
	    var birthdate = $("#birthdate").val();
	    var address = $("#address").val();
	    var location = $("#locationC").val();
	    var phonenumber = $("#phonenumber").val();
	    var email = $("#email").val();
	    var introduction =$("#introduction").val();

	    //___________________________________
	    let account_regex = new RegExp(/(?=.*\d)(?=.*[a-zA-Z]).{6,20}$/);
	    if(!account_regex.test(account))
	    {
	    	alert("帳號需為 6 ~ 20 字英文數字組成\n至少包含1個大寫英文\n至少包含一個數字");
			return;
	    }
	    let password_regex = new RegExp(/^(?=.*\d)(?=.*[a-zA-Z]).{6,16}$/);
	    if(!password_regex.test(password))
	    {
	  		 alert("密碼需為 6 ~ 16 字英文組成\n至少包含1個大小寫英文\n至少包含一個數字")
			return;
	    }
	    if(password != rePassword)
	    {
	  		 alert("密碼比對不相同，請再次輸入")
			return;
	    }
	    if(gender == null)
	    {
	  		 alert("請輸入性別")
			return;
	    }
	    let nickname_regex = new RegExp(/^.{1,20}$/);
	    if(!nickname_regex.test(nickname))
	    {
	  		 alert("暱稱請輸入 1~20 個字元")
			return;
	    }
	    let phonenumber_regex = new RegExp(/^09[0-9]{8}$/);
	    if(!phonenumber_regex.test(phonenumber))
	    {
	  		 alert("手機格式錯誤")
			return;
	    }
	    let email_regex = new RegExp(/^[^@\s]+@[^@\s]+\.[^@\s]+$/);
	    if(!email_regex.test(email))
	    {
	  		 alert("Email格式錯誤")
			return;
	    }
	    // // 创建包含用户名和密码的数据对象
	    var data = {
	      account: account,
	      password: password,
        gender: gender,
        nickname:nickname,
        birthdate:birthdate,
        address:address,
        location:location,
        phonenumber:phonenumber,
        email:email,
        introduction:introduction
	    };
	    // // 发送 AJAX POST 请求到后端Servlet
	    $.ajax({
	      type: "POST",
	      url: endPointURL+"/Register", // 替换为你的Servlet的URL
	      data: data,
        dataType: "json", // 預期會接收到回傳資料的格式： json | xml | html
	      success: function (res) {
          console.log(res.res);
          if(res.res == "AccountFail")
            alert("帳號重複，請更換");
          else if(res.res == "EmailFail")
            alert("email重複，請更換");
          else
           window.location.href = "VerificationLetter.html";	
     
	      },
	      error: function () {
	        // 在请求失败时执行的操作
	        console.log("失敗");
	      }
    });
  });
    
  // $(document).ready(function() {
  //   // 在这里执行您的代码
  //   // var test = document.getElementById("location");
  //   $("#locationC").append("<option value='1'>Text</option>");
  //   $("#locationC").append("<option value='2'>Text</option>");
  //   $("#locationC").append("<option value='3'>Text</option>");
  //   $("#locationC").append("<option value='4'>Text</option>");
  //   $("#locationC").append("<option value='5'>Text</option>");
  //   $("#locationC").append("<option value='6'>Text</option>");
  //   console.log("22");
  //   });

  //     option.value = country.code; // 使用国家代码作为值
  //     option.text = country.name;  // 使用国家名称作为显示文本
  //     countrySelect.appendChild(option);


  fetch("https://restcountries.com/v3/all")
  .then(response => response.json())
  .then(data => {
    // 提取国家的代码（code）和名称（name）
    const countriesData = data.map(country => ({
      code: country.cca3, // 或者 country.cca3，具体根据 API 数据而定
      name: country.name.common
    }));

    $.each(countriesData,function(index) {
    $("#locationC").append("<option value='"+countriesData[index].code+"'>"+countriesData[index].name+"</option>");
      
    });
  })
  .catch(error => {
    console.error("失敗: " + error);
  });


    </script>
  </body>
</html>
